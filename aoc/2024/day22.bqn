u  â‡ â€¢Import "/home/cph/bqn-test/test.bqn"
fn â‡ â€¢Import "/home/cph/bqn-code/lib/fun.bqn"

testInput  â† â€¢pathâˆ¾"/data/22-test.txt"
testInputB â† â€¢pathâˆ¾"/data/22-testb.txt"
input      â† â€¢pathâˆ¾"/data/22.txt"

# Parsing
Parse â† â€¢BQNÂ¨â€¢file.Lines

# Solutions
Xor â† 32â€¢bit._xor
P   â† 16777216âŠ¸|                                    # prune
Ns  â† (XorâŸœ(P 2048âŠ¸Ã—))Â·(P XorâŸœ(âŒŠÃ·âŸœ32))Â·P XorâŸœ(64âŠ¸Ã—) # next step
A   â† +Â´NsâŸ2000

Nsg â† âˆ¾âŸœ(Ns Â¯1âŠ¸â†‘)                                                   # next step generate
c   â† â€¢HashMapËœâŸ¨âŸ©                                                   # cache
V   â† { c.Has ğ•¨ ? ğ•¨ c.Set ğ•©+c.Get ğ•¨ ; ğ•¨ c.Set ğ•© }                   # saVe
Pb  â† { m â† âˆŠds â† 4â†•fn.Deltas p â† 10|NsgâŸ2000 ğ•© â‹„ (m/<Ë˜ds)VÂ¨m/4â†“p } # per buyer
B   â† { Pbâˆ˜â‹ˆÂ¨ğ•© â‹„ âŒˆÂ´c.Values@ }

# # Tests
u.UnitTest (A Parse testInput)  â‰¡ 37327623
# u.UnitTest (A Parse input)    â‰¡ 14622549304
u.UnitTest (B Parse testInputb) â‰¡ 23
# u.UnitTest (B Parse input)    â‰¡ 1735
