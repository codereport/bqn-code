u â‡ â€¢Import "/home/cph/bqn-test/test.bqn"
s â‡ â€¢Import "/home/cph/bqn-code/lib/string.bqn"

testInput â† â€¢pathâˆ¾"/data/09-test.txt"
input     â† â€¢pathâˆ¾"/data/09.txt"

# Parsing
Parse â† Â¯1â†“â€¢file.Chars

# Solutions
Rdfb â† { idâ€¿i â† âŸ¨âŠ‘Â¯1â†‘ğ•©,âŠ‘/'.'=ğ•©âŸ© â‹„ s.Trim2 Â¯1â†“idâŒ¾(iâŠ¸âŠ‘)ğ•© } # replace dot from back
S2D  â† { â€¢ParseFloatâˆ˜â¥ŠÂ¨ğ•© }                               # string to digits
A    â† {
    mâ€¿n â† (âŒˆÃ·âŸœ2)âŠ¸â‹ˆâ‰ ğ•©
    t â† (S2Dğ•©)/nâ†‘â¥Šâ‰(mâ¥Š'.')â‰Ëœâ†•m
    +Â´â†•âˆ˜â‰ âŠ¸Ã—Rdfbâ€¢_while_(âˆ¨Â´'.'=âŠ¢)t
}

Ids â† âˆ¾(1-Ëœâ‰ )â—¶âŸ¨â¥ŠâŸœ0,â¥ŠÂ´âŸ©Â¨
Ibfb â† { ğ•Šnâ€¿s: # insert block from back
    n    â†© 1âŠ¸+â€¢_while_{1=â‰ âŠ‘sâ†‘Ëœ-ğ•©}n
    câ€¿id â† âŠ‘sâ†‘Ëœ-n            # countâ€¿id
    m â† (1=â‰ )â—¶âŸ¨0,câŠ¸â‰¤âŸ©Â¨(-n)â†“s # mask
    { âˆ¨Â´m ? i â† âŠ‘/m â‹„ { i â‰¥ n-Ëœâ‰ s ? âŸ¨n+1,sâŸ© ;
        front â† iâ†‘s
        mid   â† <câ‹ˆid
        rem   â† (iâŠ‘s)(Ã—-)â—¶âŸ¨âŸ¨âŸ©,-âŸ©c
        back  â† câŒ¾((-n)âŠ¸âŠ‘)(i+1)â†“s
        âŸ¨n+1,frontâˆ¾midâˆ¾remâˆ¾backâŸ©
    } ; âŸ¨n+1,sâŸ© }
}

B â† {
    m â† Â¬2|â†•â‰ ğ•©
    nâ€¿f â† Ibfbâ€¢_while_(âŠ‘<â‰ âˆ˜(âŠ¢Â´)) 1â‹ˆ{ğ•©â‹ˆÂ¨â†•â‰ ğ•©}âŒ¾(mâŠ¸/)S2D ğ•©
    +Â´â†•âˆ˜â‰ âŠ¸Ã— Ids f
}

# Tests
u.UnitTest (A Parse testInput) â‰¡ 1928
# u.UnitTest (A Parse input)   â‰¡ 6330095022244
u.UnitTest (B Parse testInput) â‰¡ 2858
# u.UnitTest (B Parse input)   â‰¡ 6359491814941
